================
Kalman Filter
================

全文摘自：

`https://blog.csdn.net/heyijia0327/article/details/17487467 <https://blog.csdn.net/heyijia0327/article/details/17487467>`_
`https://bbs.21ic.com/icview-292853-1-1.html <https://bbs.21ic.com/icview-292853-1-1.html>`_

卡尔曼滤波器是在估计 **线性系统** 状态的过程中，以 **最小均方误差** 为目的而推导出的几个递推数学等式,也可以从 **贝叶斯推断** 的角度来推导。

其中协方差矩阵的主对角线就是方差，反对角线上的就是两个变量间的协方差
就上面的二元高斯分布而言，协方差越大，图像越扁，也就是说两个维度之间越有联系。

假设我们知道一个 **线性系统** 的状态差分方程为

.. math::
   x_k = Ax_{k-1} + Bu_{k-1} + w_{k-1}

其中，

- :math:`x` 是系统的状态向量，``shape`` 为 ``(n, 1)``
- :math:`A` 是状态转换矩阵，``shape`` 为 ``(n, n)``
- :math:`u` 是系统的输入，``shape`` 为 ``(k, 1)``
- :math:`B` 是将输入转化为状态的矩阵，``shape`` 为 ``(n, k)``
- :math:`w` 是系统噪声，``shape`` 为 ``(n, 1)``

引进反馈。从概率论贝叶斯模型的观点来看前面预测的结果就是先验，测量出的结果就是后验。

测量值当然是由系统状态变量映射出来的，方程形式如下：

.. math:: 
   z_k = Hx_k + v_k

其中，

- :math:`z` 是测量值，``shape`` 为 ``(m, 1)``
- :math:`Hx_k` 是状态变量到测量的转换矩阵，``shape`` 为 ``(m, n)``
- :math:`v` 是测量噪声，``shape`` 为 ``(m, 1)``


状态方程中的系统噪声 :math:`w` 和测量噪声 :math:`v` ，假设服从如下多元高斯分布，并且 :math:`w` ，:math:`v` 是相互独立的

.. math:: 
   P(w) \sim N(0, Q)

   P(v) \sim N(0, R)

理论预测（先验）有了，测量值（后验）也有了，那怎么根据这两者得到最优的估计值呢？首先想到的就是 **加权**，或者称之为 **反馈**。










先看估计值和真实值间误差的协方差矩阵，提醒一下协方差矩阵的对角线元素就是方差，求这个协方差矩阵，就是为了利用他的对角线元素的和计算得到均方差.

.. math::

   P_k = E[e_ke_k^T] = E\left [ (x_k - \hat{x}_k) (x_k - \hat{x}_k)^T \right ]













:math:`\frac{ \sum_{t=0}^{N}f(t,k) }{N}`

.. math:: \alpha{}_t(i) = P(O_1, O_2, … O_t, q_t = S_i \lambda{})
